<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Register - GreenRide</title>
    <link th:href="@{/css/app.css}" rel="stylesheet"/>
    <link th:href="@{/css/pages.css}" rel="stylesheet"/>
    <!-- Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
<div class="login-container">
    <!-- Floating background elements -->
    <div class="floating-element floating-1"></div>
    <div class="floating-element floating-2"></div>

    <div class="login-card">
        <!-- Header with Logo -->
        <div class="login-header">
            <div class="login-logo">
                <div class="logo-icon">
                    <i class="fas fa-car"></i>
                </div>
            </div>
            <h1>Join GreenRide</h1>
            <p>Create your account in seconds</p>
        </div>

        <!-- Registration Form -->
        <form class="login-form" th:action="@{/web/auth/register}" th:object="${registerRequest}" method="post">
            <!-- Full Name Field -->
            <div class="form-group">
                <label for="fullName">FULL NAME</label>
                <div style="position: relative;">
                    <input type="text"
                           id="fullName"
                           th:field="*{fullName}"
                           class="form-input"
                           placeholder="Enter your full name"
                           required>
                    <i class="fas fa-user input-icon"></i>
                </div>
                <span th:if="${#fields.hasErrors('fullName')}"
                      th:errors="*{fullName}"
                      class="error-message"></span>
            </div>

            <!-- Email Field -->
            <div class="form-group">
                <label for="email">EMAIL ADDRESS</label>
                <div style="position: relative;">
                    <input type="email"
                           id="email"
                           th:field="*{email}"
                           class="form-input"
                           placeholder="Enter your email address"
                           required>
                    <i class="fas fa-envelope input-icon"></i>
                </div>
                <span th:if="${#fields.hasErrors('email')}"
                      th:errors="*{email}"
                      class="error-message"></span>
            </div>

            <!-- Username Field -->
            <div class="form-group">
                <label for="username">USERNAME</label>
                <div style="position: relative;">
                    <input type="text"
                           id="username"
                           th:field="*{username}"
                           class="form-input"
                           placeholder="Choose a username"
                           required>
                    <i class="fas fa-at input-icon"></i>
                </div>
                <span th:if="${#fields.hasErrors('username')}"
                      th:errors="*{username}"
                      class="error-message"></span>
            </div>

            <!-- Password Field -->
            <div class="form-group">
                <label for="password">PASSWORD</label>
                <div style="position: relative; margin-bottom: 20px">
                    <input type="password"
                           id="password"
                           th:field="*{password}"
                           class="form-input"
                           placeholder="Create a strong password"
                           required>
                    <i class="fas fa-lock input-icon"></i>
                    <i class="fas fa-eye-slash password-toggle"
                       style="position: absolute; right: 16px; top: 50%; transform: translateY(-50%); cursor: pointer; color: #94a3b8;"></i>
                </div>
                <span th:if="${#fields.hasErrors('password')}"
                      th:errors="*{password}"
                      class="error-message"></span>

                <!-- Confirm Password Field -->
                <div class="form-group">
                    <label for="confirmPassword">CONFIRM PASSWORD</label>
                    <div style="position: relative;">
                        <input type="password"
                               id="confirmPassword"
                               class="form-input"
                               placeholder="Confirm your password"
                               required>
                        <i class="fas fa-lock input-icon"></i>
                    </div>
                    <span class="error-message" id="confirmPasswordError"
                          style="display: none;">Passwords do not match</span>
                </div>


                <!-- Role Selection -->
                <div class="form-group">
                    <label>I WANT TO JOIN AS</label>
                    <div class="role-selection">
                        <div class="role-option" data-value="DRIVER">
                            <div class="role-icon">
                                <i class="fas fa-car-side"></i>
                            </div>
                            <div class="role-name">Driver</div>
                            <div class="role-description">Offer rides and earn money</div>
                        </div>
                        <div class="role-option" data-value="PASSENGER">
                            <div class="role-icon">
                                <i class="fas fa-user-friends"></i>
                            </div>
                            <div class="role-name">Passenger</div>
                            <div class="role-description">Find and book rides</div>
                        </div>
                    </div>
                    <!-- Hidden select for form submission -->
                    <select th:field="*{role}" id="roleSelect" style="display: none;">
                        <option value="DRIVER">Driver</option>
                        <option value="PASSENGER">Passenger</option>
                    </select>
                    <span th:if="${#fields.hasErrors('role')}"
                          th:errors="*{role}"
                          class="error-message"></span>
                </div>

                <!-- Submit Button -->
                <button type="submit" class="btn-login" id="submitButton">
                    <i class="fas fa-user-plus"></i>
                    Create Account
                </button>
        </form>

        <!-- Divider -->
        <div class="divider">
            <span>Already have an account?</span>
        </div>

        <!-- Login Link -->
        <div class="login-links">
            <a th:href="@{/web/auth/login}">
                <i class="fas fa-sign-in-alt"></i>
                Sign in to your account
            </a>
        </div>
    </div>
</div>

<!-- JavaScript for Registration Page -->
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Password visibility toggle
        const passwordToggle = document.querySelector('.password-toggle');
        const passwordInput = document.getElementById('password');

        if (passwordToggle && passwordInput) {
            passwordToggle.addEventListener('click', function() {
                const type = passwordInput.type === 'password' ? 'text' : 'password';
                passwordInput.type = type;
                this.classList.toggle('fa-eye-slash');
                this.classList.toggle('fa-eye');
            });
        }


        // Confirm password validation
        const confirmPasswordInput = document.getElementById('confirmPassword');
        const confirmPasswordError = document.getElementById('confirmPasswordError');

        function validatePasswordMatch() {
            const password = passwordInput.value;
            const confirmPassword = confirmPasswordInput.value;

            if (confirmPassword && password !== confirmPassword) {
                confirmPasswordError.style.display = 'block';
                confirmPasswordInput.style.borderColor = '#ef4444';
                return false;
            } else {
                confirmPasswordError.style.display = 'none';
                confirmPasswordInput.style.borderColor = '#e2e8f0';
                return true;
            }
        }

        confirmPasswordInput.addEventListener('input', validatePasswordMatch);

        // Role selection
        const roleOptions = document.querySelectorAll('.role-option');
        const roleSelect = document.getElementById('roleSelect');

        roleOptions.forEach(option => {
            option.addEventListener('click', function() {
                // Remove selected class from all options
                roleOptions.forEach(opt => opt.classList.remove('selected'));

                // Add selected class to clicked option
                this.classList.add('selected');

                // Update hidden select value
                const value = this.getAttribute('data-value');
                roleSelect.value = value;
            });
        });

        // Set initial role selection
        if (roleSelect.value) {
            const initialOption = document.querySelector(`.role-option[data-value="${roleSelect.value}"]`);
            if (initialOption) {
                initialOption.classList.add('selected');
            }
        }

        // Form validation before submission
        const registerForm = document.querySelector('.login-form');
        const submitButton = document.getElementById('submitButton');

        registerForm.addEventListener('submit', function(event) {
            if (!validateForm()) {
                event.preventDefault();
            }
        });

        function validateForm() {
            let isValid = true;

            // Check password match
            if (!validatePasswordMatch()) {
                isValid = false;
            }


            // Update submit button state
            submitButton.disabled = !isValid;
            submitButton.style.opacity = isValid ? '1' : '0.7';
            submitButton.style.cursor = isValid ? 'pointer' : 'not-allowed';

            return isValid;
        }

        // Real-time form validation
        const formInputs = document.querySelectorAll('.form-input');
        formInputs.forEach(input => {
            input.addEventListener('input', validateForm);
            input.addEventListener('blur', validateForm);
        });

        // Terms checkbox validation
        const termsCheckbox = document.getElementById('termsCheckbox');
        if (termsCheckbox) {
            termsCheckbox.addEventListener('change', validateForm);
        }

        // Initial form validation
        validateForm();

        // Add focus effects to all inputs
        const inputs = document.querySelectorAll('.form-input');
        inputs.forEach(input => {
            input.addEventListener('focus', function() {
                const icon = this.parentElement.querySelector('.input-icon');
                if (icon) icon.style.color = '#10b981';
                this.style.borderColor = '#10b981';
                this.style.boxShadow = '0 0 0 3px rgba(16, 185, 129, 0.1)';
            });

            input.addEventListener('blur', function() {
                const icon = this.parentElement.querySelector('.input-icon');
                if (icon) icon.style.color = '#94a3b8';
                this.style.borderColor = '#e2e8f0';
                this.style.boxShadow = 'none';
            });
        });
    });
</script>
</body>
</html>
