{"openapi":"3.1.0","info":{"title":"GreenRide API","description":"REST API για την πλατφόρμα GreenRide","contact":{"name":"GreenRide Team","email":"team@greenride.local"},"version":"1.0"},"servers":[{"url":"http://localhost:8080","description":"Local"}],"tags":[{"name":"External APIs","description":"Endpoints που καλούν εξωτερικές υπηρεσίες"},{"name":"External APIs (Routee)","description":"Secured Routee calls (OAuth token + Bearer)"},{"name":"Geolocation","description":"Geocoding via OpenStreetMap Nominatim"}],"paths":{"/rides/{id}":{"get":{"tags":["ride-controller"],"operationId":"getRide","parameters":[{"name":"id","in":"path","required":true,"schema":{"type":"integer","format":"int64"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/RideResponseDTO"}}}}}},"put":{"tags":["ride-controller"],"operationId":"updateRide","parameters":[{"name":"id","in":"path","required":true,"schema":{"type":"integer","format":"int64"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/RideRequestDTO"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/RideResponseDTO"}}}}}},"delete":{"tags":["ride-controller"],"operationId":"deleteRide","parameters":[{"name":"id","in":"path","required":true,"schema":{"type":"integer","format":"int64"}}],"responses":{"204":{"description":"No Content"}}}},"/reviews/{id}":{"get":{"tags":["review-controller"],"operationId":"getById","parameters":[{"name":"id","in":"path","required":true,"schema":{"type":"integer","format":"int64"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ReviewResponseDTO"}}}}}},"put":{"tags":["review-controller"],"operationId":"update","parameters":[{"name":"id","in":"path","required":true,"schema":{"type":"integer","format":"int64"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ReviewRequestDTO"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ReviewResponseDTO"}}}}}},"delete":{"tags":["review-controller"],"operationId":"delete","parameters":[{"name":"id","in":"path","required":true,"schema":{"type":"integer","format":"int64"}}],"responses":{"204":{"description":"No Content"}}}},"/bookings/{id}/cancel":{"put":{"tags":["booking-controller"],"operationId":"cancelBooking","parameters":[{"name":"id","in":"path","required":true,"schema":{"type":"integer","format":"int64"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/BookingResponseDTO"}}}}}}},"/user-reports":{"get":{"tags":["user-report-controller"],"operationId":"getAll","responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/UserReportResponseDTO"}}}}}}},"post":{"tags":["user-report-controller"],"operationId":"create","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserReportRequestDTO"}}},"required":true},"responses":{"201":{"description":"Created","content":{"*/*":{"schema":{"$ref":"#/components/schemas/UserReportResponseDTO"}}}}}}},"/rides":{"get":{"tags":["ride-controller"],"operationId":"getAllRides","responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/RideResponseDTO"}}}}}}},"post":{"tags":["ride-controller"],"operationId":"createRide","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/RideRequestDTO"}}},"required":true},"responses":{"201":{"description":"Created","content":{"*/*":{"schema":{"$ref":"#/components/schemas/RideResponseDTO"}}}}}}},"/reviews":{"post":{"tags":["review-controller"],"operationId":"create_1","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ReviewRequestDTO"}}},"required":true},"responses":{"201":{"description":"Created","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ReviewResponseDTO"}}}}}}},"/external/jsonplaceholder/posts":{"post":{"tags":["External APIs"],"summary":"POST to external API (JSONPlaceholder)","description":"Κάνει POST σε εξωτερική υπηρεσία και επιστρέφει την απάντηση.","operationId":"createExternalPost","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/JsonPlaceholderPostRequestDTO"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/JsonPlaceholderPostResponseDTO"}}}}}}},"/bookings":{"get":{"tags":["booking-controller"],"operationId":"getAllBookings","responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/BookingResponseDTO"}}}}}}},"post":{"tags":["booking-controller"],"operationId":"createBooking","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/BookingRequestDTO"}}},"required":true},"responses":{"201":{"description":"Created","content":{"*/*":{"schema":{"$ref":"#/components/schemas/BookingResponseDTO"}}}}}}},"/auth/register":{"post":{"tags":["auth-controller"],"operationId":"register","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserRegistrationDTO"}}},"required":true},"responses":{"201":{"description":"Created","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AuthResponseDTO"}}}}}}},"/auth/login":{"post":{"tags":["auth-controller"],"operationId":"login","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserLoginDTO"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AuthResponseDTO"}}}}}}},"/users":{"get":{"tags":["user-controller"],"operationId":"getAll_1","responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/UserDTO"}}}}}}}},"/users/{id}":{"get":{"tags":["user-controller"],"operationId":"getById_1","parameters":[{"name":"id","in":"path","required":true,"schema":{"type":"integer","format":"int64"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/UserDTO"}}}}}}},"/user-reports/{id}":{"get":{"tags":["user-report-controller"],"operationId":"getById_2","parameters":[{"name":"id","in":"path","required":true,"schema":{"type":"integer","format":"int64"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/UserReportResponseDTO"}}}}}}},"/reviews/user/{userId}":{"get":{"tags":["review-controller"],"operationId":"getByUser","parameters":[{"name":"userId","in":"path","required":true,"schema":{"type":"integer","format":"int64"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/ReviewResponseDTO"}}}}}}}},"/reviews/ride/{rideId}":{"get":{"tags":["review-controller"],"operationId":"getByRide","parameters":[{"name":"rideId","in":"path","required":true,"schema":{"type":"integer","format":"int64"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/ReviewResponseDTO"}}}}}}}},"/geo/test":{"get":{"tags":["Geolocation"],"summary":"Test geocoding","description":"Test endpoint to debug geocoding","operationId":"testGeocode","parameters":[{"name":"q","in":"query","required":false,"schema":{"type":"string","default":"Athens, Greece"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"string"}}}}}}},"/geo/route":{"get":{"tags":["Geolocation"],"summary":"Get route details","description":"Distance, time, polyline for map","operationId":"getRoute","parameters":[{"name":"from","in":"query","required":true,"schema":{"type":"string"}},{"name":"to","in":"query","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/RouteDetails"}}}}}}},"/geo/forward":{"get":{"tags":["Geolocation"],"summary":"Forward geocoding","description":"Μετατρέπει διεύθυνση/πόλη σε συντεταγμένες (lat/lon).","operationId":"forward","parameters":[{"name":"q","in":"query","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/GeoLocationResponseDTO"}}}}}}},"/geo/athens/route":{"get":{"tags":["Geolocation"],"summary":"Calculate route between Athens locations","description":"Fast route calculation using predefined coordinates","operationId":"getAthensRoute","parameters":[{"name":"from","in":"query","required":true,"schema":{"type":"string"}},{"name":"to","in":"query","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/RouteDetails"}}}}}}},"/geo/athens/locations":{"get":{"tags":["Geolocation"],"summary":"Get Athens locations","description":"Get list of predefined Athens locations","operationId":"getAthensLocations","parameters":[{"name":"q","in":"query","required":false,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/AthensLocation"}}}}}}}},"/external/routee/phone/validate":{"get":{"tags":["External APIs (Routee)"],"summary":"Routee phone validation (secured)","description":"Gets OAuth token then calls Routee phone validation with Bearer token.","operationId":"validate","parameters":[{"name":"phone","in":"query","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/RouteePhoneValidationResponseDTO"}}}}}}},"/debug/user-info":{"get":{"tags":["web-controller"],"operationId":"debugUserInfo","responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"string"}}}}}}},"/debug/session":{"get":{"tags":["web-controller"],"operationId":"debugSession","responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"string"}}}}}}},"/debug/ride/{id}":{"get":{"tags":["web-controller"],"operationId":"debugRide","parameters":[{"name":"id","in":"path","required":true,"schema":{"type":"integer","format":"int64"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"string"}}}}}}},"/bookings/{id}":{"get":{"tags":["booking-controller"],"operationId":"getBooking","parameters":[{"name":"id","in":"path","required":true,"schema":{"type":"integer","format":"int64"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/BookingResponseDTO"}}}}}},"delete":{"tags":["booking-controller"],"operationId":"deleteBooking","parameters":[{"name":"id","in":"path","required":true,"schema":{"type":"integer","format":"int64"}}],"responses":{"204":{"description":"No Content"}}}},"/bookings/ride/{rideId}":{"get":{"tags":["booking-controller"],"operationId":"getBookingsByRide","parameters":[{"name":"rideId","in":"path","required":true,"schema":{"type":"integer","format":"int64"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/BookingResponseDTO"}}}}}}}},"/bookings/passenger/{passengerId}":{"get":{"tags":["booking-controller"],"operationId":"getBookingsByPassenger","parameters":[{"name":"passengerId","in":"path","required":true,"schema":{"type":"integer","format":"int64"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/BookingResponseDTO"}}}}}}}}},"components":{"schemas":{"RideRequestDTO":{"type":"object","properties":{"driverId":{"type":"integer","format":"int64"},"startDatetime":{"type":"string","format":"date-time"},"endDatetime":{"type":"string","format":"date-time"},"fromCity":{"type":"string","maxLength":100,"minLength":0},"fromAddress":{"type":"string","maxLength":255,"minLength":0},"toCity":{"type":"string","maxLength":100,"minLength":0},"toAddress":{"type":"string","maxLength":255,"minLength":0},"distanceKm":{"type":"number","minimum":0.0},"estimatedDurationMin":{"type":"integer","format":"int32","minimum":1},"availableSeatsTotal":{"type":"integer","format":"int32","maximum":8,"minimum":1},"pricePerSeat":{"type":"number","minimum":0.01}},"required":["availableSeatsTotal","fromCity","pricePerSeat","startDatetime","toCity"]},"RideResponseDTO":{"type":"object","properties":{"id":{"type":"integer","format":"int64"},"driverId":{"type":"integer","format":"int64"},"driverUsername":{"type":"string"},"driverFullName":{"type":"string"},"startDatetime":{"type":"string","format":"date-time"},"endDatetime":{"type":"string","format":"date-time"},"fromCity":{"type":"string"},"fromAddress":{"type":"string"},"toCity":{"type":"string"},"toAddress":{"type":"string"},"distanceKm":{"type":"number"},"estimatedDurationMin":{"type":"integer","format":"int32"},"availableSeatsTotal":{"type":"integer","format":"int32"},"availableSeatsRemain":{"type":"integer","format":"int32"},"pricePerSeat":{"type":"number"},"status":{"type":"string"},"weatherSummary":{"type":"string"},"createdAt":{"type":"string","format":"date-time"}}},"ReviewRequestDTO":{"type":"object","properties":{"rideId":{"type":"integer","format":"int64"},"reviewerId":{"type":"integer","format":"int64"},"revieweeId":{"type":"integer","format":"int64"},"roleOfReviewee":{"type":"string","maxLength":20,"minLength":0},"rating":{"type":"integer","format":"int32","maximum":5,"minimum":1},"comment":{"type":"string","maxLength":1000,"minLength":0}},"required":["rating","revieweeId","reviewerId","rideId","roleOfReviewee"]},"ReviewResponseDTO":{"type":"object","properties":{"id":{"type":"integer","format":"int64"},"rideId":{"type":"integer","format":"int64"},"reviewerId":{"type":"integer","format":"int64"},"revieweeId":{"type":"integer","format":"int64"},"roleOfReviewee":{"type":"string"},"rating":{"type":"integer","format":"int32"},"comment":{"type":"string"},"createdAt":{"type":"string","format":"date-time"}}},"BookingResponseDTO":{"type":"object","properties":{"id":{"type":"integer","format":"int64"},"rideId":{"type":"integer","format":"int64"},"passengerId":{"type":"integer","format":"int64"},"seatsBooked":{"type":"integer","format":"int32"},"totalPrice":{"type":"number"},"status":{"type":"string"},"bookedAt":{"type":"string","format":"date-time"},"cancelledAt":{"type":"string","format":"date-time"}}},"UserReportRequestDTO":{"type":"object","properties":{"reportedUserId":{"type":"integer","format":"int64"},"reporterUserId":{"type":"integer","format":"int64"},"reason":{"type":"string","maxLength":1000,"minLength":0}},"required":["reason","reportedUserId"]},"UserReportResponseDTO":{"type":"object","properties":{"id":{"type":"integer","format":"int64"},"reportedUserId":{"type":"integer","format":"int64"},"reporterUserId":{"type":"integer","format":"int64"},"reason":{"type":"string"},"status":{"type":"string"},"createdAt":{"type":"string","format":"date-time"},"resolvedAt":{"type":"string","format":"date-time"}}},"JsonPlaceholderPostRequestDTO":{"type":"object","properties":{"title":{"type":"string","minLength":1},"body":{"type":"string","minLength":1},"userId":{"type":"integer","format":"int32"}},"required":["body","title","userId"]},"JsonPlaceholderPostResponseDTO":{"type":"object","properties":{"id":{"type":"integer","format":"int32"},"title":{"type":"string"},"body":{"type":"string"},"userId":{"type":"integer","format":"int32"}}},"BookingRequestDTO":{"type":"object","properties":{"rideId":{"type":"integer","format":"int64"},"passengerId":{"type":"integer","format":"int64"},"seatsRequested":{"type":"integer","format":"int32","minimum":1}},"required":["passengerId","rideId"]},"UserRegistrationDTO":{"type":"object","properties":{"username":{"type":"string","maxLength":50,"minLength":3},"password":{"type":"string","maxLength":100,"minLength":6},"fullName":{"type":"string","maxLength":100,"minLength":0},"email":{"type":"string","format":"email","maxLength":120,"minLength":0},"phone":{"type":"string","maxLength":30,"minLength":0},"role":{"type":"string","minLength":1}},"required":["email","fullName","password","role","username"]},"AuthResponseDTO":{"type":"object","properties":{"token":{"type":"string"},"tokenType":{"type":"string"},"userId":{"type":"integer","format":"int64"},"username":{"type":"string"},"role":{"type":"string"}}},"UserLoginDTO":{"type":"object","properties":{"username":{"type":"string","minLength":1},"password":{"type":"string","minLength":1}},"required":["password","username"]},"UserDTO":{"type":"object","properties":{"id":{"type":"integer","format":"int64"},"username":{"type":"string"},"fullName":{"type":"string"},"email":{"type":"string"},"phone":{"type":"string"},"status":{"type":"string"},"role":{"type":"string"},"ratingAvgDriver":{"type":"number"},"ratingAvgPassenger":{"type":"number"},"createdAt":{"type":"string","format":"date-time"}}},"RouteDetails":{"type":"object","properties":{"distanceKm":{"type":"number","format":"double"},"durationMinutes":{"type":"integer","format":"int32"},"polyline":{"type":"string"}}},"GeoLocationResponseDTO":{"type":"object","properties":{"lat":{"type":"number","format":"double"},"lon":{"type":"number","format":"double"},"displayName":{"type":"string"}}},"AthensLocation":{"type":"object","properties":{"name":{"type":"string"},"displayName":{"type":"string"},"lat":{"type":"number","format":"double"},"lon":{"type":"number","format":"double"}}},"RouteePhoneValidationResponseDTO":{"type":"object","properties":{"phone":{"type":"string"},"valid":{"type":"boolean"}}}}}}